{{ define "content" }}

<!-- What is this author's name ? -->
{{- $thisauthor := .Params.author -}}

<!-- Get the details from the authors csv -->
{{- $url := "/csv/authors.csv" -}}
{{- $sep := "," -}}
{{- range $i, $r := getCSV $sep $url -}}
    {{- $author := index $r 8 -}}
    {{- if eq $author $thisauthor -}}
        {{- $.Scratch.Set "profession" (index $r 9) -}}
        {{- $.Scratch.Set "nationality" (index $r 10) -}}
        {{- $.Scratch.Set "dob" (index $r 11) -}}
        {{- $.Scratch.Set "dod" (index $r 12) -}}
        {{- $.Scratch.Set "briefbio" (index $r 13) -}}
        {{- $.Scratch.Set "fullbio" (index $r 17) -}}
    {{- end -}}
{{- end -}}

{{- if isset .Params "background" -}}
<!-- <img src="{{ .Params.background }}" style="position: fixed; right: 0; top: 0; width: 100%; height: auto; z-index: -1; opacity: 0.6;" /> -->
{{- end -}}

<div class="section bb">
    <div class="container">
        <div class="row">
            <div class="col s12 m9 l9">
                <h2>{{ .Params.author }}</h2>
                <div class="grid">

                    <div class="gutter-sizer"></div>
                    <div class="grid-sizer"></div>

                    <!-- <div class="gi s12 m12 l4">
                        <div class="card fluid center">
                            <h2 class="c-quotes-gradient">
                                {{- .Params.Author -}}
                            </h2>
                        </div>
                    </div> -->

                    <!-- <div class="grid-item">
                        <div class="card">
                            <h3>BIO</h3>
                            <p>{{- $.Scratch.Get "briefbio" -}}</p>
                        </div>
                    </div> -->

                    {{ $.Scratch.Set "image" .Params.image }}
                    {{- $url := "/csv/quotes.csv" -}}
                    {{- $sep := "," -}}
                    {{- $.Scratch.Delete "quoteid" -}}
                    {{- $.Scratch.Set "quoteid" 1 -}}
                    {{- range $i, $r := getCSV $sep $url -}}
                    {{- $author := index $r 3 -}}
                    {{- $tags := index $r 9 -}}
                    {{- if eq $author $thisauthor -}}
                    {{- $quote := index $r 8 -}}
                    {{- if lt ($quote | countwords) 10 -}}
                    <div class="gi s12 m6 l4">
                    {{- else if lt ($quote | countwords) 20 -}}
                    <div class="gi s12 m6 l4">
                    {{- else -}}
                    <div class="gi s12 m6 l4">
                    {{- end -}}
                    {{- if eq (mod ($.Scratch.Get "quoteid") 5) 0 -}}
                        <div class="card quote bg-quotes-gradient z-depth-3">
                            <div class="carousel-cell">
                                <figure>
                                    <blockquote>{{ $quote }}</blockquote>
                                    <figcaption>{{ $author }}</figcaption>
                                </figure>
                            </div>
                        </div>
                    {{- else -}}
                        <div class="card fluid no-bg font-4" data-k-tagcsv="{{ $tags }}" data-k-quoteid="{{ $.Scratch.Get "quoteid" }}">
                            <div class="img-container" id="img_container_{{ $.Scratch.Get "quoteid" }}">
                                <img src="https://source.unsplash.com/600x200/?{{ $tags }}" />
                            </div>
                            <div class="content" id="content_{{ $.Scratch.Get "quoteid" }}">
                                <h4 class="title">"{{ $quote }}"</h4>
                                <h5>{{ $author }}</h5>
                            </div>
                        </div>
                    {{- end -}}

                        <!-- <div class="card quote bg-dark-to-right" >
                            <figure class="z-depth-5">
                                <img src="{{ $.Scratch.Get "image" }}" />
                                <blockquote>{{ $quote | humanize }}</blockquote>
                                <figcaption>{{ $author }}</figcaption>
                            </figure>
                        </div> -->
                        <!-- <blockquote class="z-depth-{{ index (seq 5 | shuffle) 0 }}"> -->
                    </div>
                    {{- end -}}
                    {{- $.Scratch.Set "quoteid" (add ($.Scratch.Get "quoteid") 1) -}}
                    {{- end -}}

                </div>
                
            </div>

            <div class="col s12 m3 l3">
                <div class="card fluid">
                    <h2>Profile</h2>
                    <h4>{{ $thisauthor }}</h4>
                    <!-- <h3 class="quotes-gradient-text">Nationality</h3> -->
                    <h4>{{ $.Scratch.Get "nationality" }}</h4>
                    <!-- <h3 class="quotes-gradient-text">Profession</h3> -->
                    <h4>{{ $.Scratch.Get "profession" }}</h4>
                    <!-- <h3 class="quotes-gradient-text">Date of Birth</h3> -->
                    <h4>DOB {{ $.Scratch.Get "dob" }}</h4>
                    <!-- <h3 class="quotes-gradient-text">Full Bio</h3> -->
                    <h4><a target="_blank" href="{{ $.Scratch.Get "fullbio" }}">Full Bio (Wikipedia) ></a></h4>
                </div>
                
                <h2>Other Authors</h2>
                {{ $related := .Site.RegularPages.Related . | first 5 }}
                {{ with $related }}
                    {{ range . }}
                    <div class="card wide s12 m12 l12 h2 bg-dark-to-right font-4">
                        {{ partial "card-author.html" .}} 
                    </div>  
                    {{ end }}
                {{ end }}

                <br/><br />
                <h2>Also See</h2>
                {{ $related := .Site.RegularPages.Related . | first 5 }}
                {{ with $related }}
                {{ range . }}
                <div class="card wide s12 m12 l12 h2 bg-dark-to-right">
                    {{ partial "card-author.html" .}}
                </div>
                {{ end }}
                {{ end }}

            </div>

        </div>
    </div>
</div>

{{ end }}